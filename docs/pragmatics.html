<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Language pragmatics | Introduction to Computational Psychology</title>
<meta name="author" content="Alan Jern">
<meta name="description" content="When we talk to each other, we often rely on shared assumptions and context to get our points across more quickly. Linguists call this pragmatics. For example, consider the following exchange: A:...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 7 Language pragmatics | Introduction to Computational Psychology">
<meta property="og:type" content="book">
<meta property="og:url" content="https://alanjern.github.io/computational-psych-book/pragmatics.html">
<meta property="og:image" content="https://alanjern.github.io/computational-psych-book/images/cover/marble_notext.jpg">
<meta property="og:description" content="When we talk to each other, we often rely on shared assumptions and context to get our points across more quickly. Linguists call this pragmatics. For example, consider the following exchange: A:...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Language pragmatics | Introduction to Computational Psychology">
<meta name="twitter:description" content="When we talk to each other, we often rely on shared assumptions and context to get our points across more quickly. Linguists call this pragmatics. For example, consider the following exchange: A:...">
<meta name="twitter:image" content="https://alanjern.github.io/computational-psych-book/images/cover/marble_notext.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicons/favicon-16x16.png">
<link rel="manifest" href="images/favicons/site.webmanifest">
<link rel="shortcut icon" href="images/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Computational Psychology</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Why computational modeling?</a></li>
<li><a class="" href="bayes.html"><span class="header-section-number">2</span> Bayesian inference</a></li>
<li><a class="" href="generalization.html"><span class="header-section-number">3</span> Generalization</a></li>
<li><a class="" href="categorization.html"><span class="header-section-number">4</span> Categorization</a></li>
<li><a class="" href="hierarchical-generalization.html"><span class="header-section-number">5</span> Hierarchical generalization</a></li>
<li><a class="" href="sampling-assumptions.html"><span class="header-section-number">6</span> Sampling assumptions</a></li>
<li><a class="active" href="pragmatics.html"><span class="header-section-number">7</span> Language pragmatics</a></li>
<li><a class="" href="social-cognition.html"><span class="header-section-number">8</span> Social cognition</a></li>
<li><a class="" href="iterated-learning.html"><span class="header-section-number">9</span> Iterated learning</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/alanjern/computational-psych-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="pragmatics" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Language pragmatics<a class="anchor" aria-label="anchor" href="#pragmatics"><i class="fas fa-link"></i></a>
</h1>
<p>When we talk to each other, we often rely on shared assumptions and context to get our points across more quickly. Linguists call this <a href="https://en.wikipedia.org/wiki/Pragmatics">pragmatics</a>. For example, consider the following exchange:</p>
<blockquote>
<p>A: I‚Äôm almost out of gas.</p>
<p>B: There‚Äôs a gas station up ahead.</p>
</blockquote>
<p>Person A didn‚Äôt explicitly ask a question, but Person B understood that A wouldn‚Äôt have said anything at all if they didn‚Äôt need something or weren‚Äôt explaining something they were about to do, so B responded with an answer to the implied question (‚ÄúWhere can I get gas?‚Äù).</p>
<p>In this chapter, we‚Äôll see how some aspects of pragmatics can be explained by combining Bayesian inference with two new ideas: <em>information theory</em> and <em>decision theory</em> (or expected utility).</p>
<div id="surprisal" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Surprisal üòØ<a class="anchor" aria-label="anchor" href="#surprisal"><i class="fas fa-link"></i></a>
</h2>
<p>We‚Äôll focus on one concept from information theory: surprisal. Surprisal captures how unexpected an observation is. Intuitively, the unexpectedness of an observation should depend how probable it is. Namely, the more probable it is, the less unexpected it is.</p>
<p>We want a function <span class="math inline">\(f(p)\)</span> that takes a probability and gives us its unexpectedness. Here are some reasonable constraints on <span class="math inline">\(f\)</span>:</p>
<ul>
<li>When an observation has probability 0, it is infinitely unexpected: <span class="math inline">\(f(0) = \infty\)</span>.</li>
<li>When an observation has probability 1, it is not unexpected at all: <span class="math inline">\(f(1) = 0\)</span>.</li>
<li>When we have two independent observations with probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, such that the probability of both occurring is <span class="math inline">\(p_1 \cdot p_2\)</span>, we want the total unexpectedness of observing both to be the sum of the unexpectedness of each observation: <span class="math inline">\(f(p_1 \cdot p_2) = f(p_1) + f(p_2)\)</span>.</li>
</ul>
<p>A function that satisfies these constraints is:</p>
<p><span class="math display">\[
f(p) = -log(p)
\]</span>
Let‚Äôs verify.</p>
<ul>
<li>
<span class="math inline">\(-log(p) \rightarrow \infty\)</span> as <span class="math inline">\(p \rightarrow 0\)</span> ‚úÖ</li>
<li>
<span class="math inline">\(-log(1) = 0\)</span> ‚úÖ</li>
<li>
<span class="math inline">\(-log(p_1 \cdot p_2) = -(log(p_1) + log(p_2)) = (-log(p_1))+(-log(p_2))\)</span> ‚úÖ</li>
</ul>
<p>Here‚Äôs a plot of this function:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="pragmatics.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb70-2"><a href="pragmatics.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb70-3"><a href="pragmatics.html#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="pragmatics.html#cb70-4" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="dv">1</span>,num<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb70-5"><a href="pragmatics.html#cb70-5" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="op">-</span>np.log(p)</span>
<span id="cb70-6"><a href="pragmatics.html#cb70-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-7"><a href="pragmatics.html#cb70-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb70-8"><a href="pragmatics.html#cb70-8" aria-hidden="true" tabindex="-1"></a>ax.plot(p, fp)</span>
<span id="cb70-9"><a href="pragmatics.html#cb70-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"p"</span>)</span>
<span id="cb70-10"><a href="pragmatics.html#cb70-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"surprisal"</span>)</span>
<span id="cb70-11"><a href="pragmatics.html#cb70-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="672"></div>
<p><em>What does surprisal have to do with language?</em></p>
<p>When you‚Äôre communicating with someone, surprisal can help you decide what information to give the other person. For example, imagine that you observe a number between 1 and 10 and you want to share it with someone else. You could either say:</p>
<blockquote>
<p>I saw an even number.</p>
</blockquote>
<p>Or you could say:</p>
<blockquote>
<p>I saw two.</p>
</blockquote>
<p>Which would you say? The second one, duh. But why?</p>
<p>In formal terms, you‚Äôre trying to send a signal such that the number you observed is not surprising for the other person after receiving your signal. That is, you‚Äôre trying to minimize the surprisal of <span class="math inline">\(P(2|\text{signal})\)</span>.</p>
<p><strong>Exercise</strong>: Compute the surprisal of each of these two signals.</p>
</div>
<div id="rsa-model" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> The Rational Speech Act model üç™<a class="anchor" aria-label="anchor" href="#rsa-model"><i class="fas fa-link"></i></a>
</h2>
<p>Let‚Äôs apply the concept of surprisal to the following example. There were initially two cookies in a cookie jar, you may have eaten some, and you‚Äôre telling your friend how many you had. You can say:</p>
<ol style="list-style-type: decimal">
<li>‚ÄúI had <em>some</em> cookies.‚Äù (You ate one or two.)</li>
<li>‚ÄúI had <em>all</em> the cookies.‚Äù (You ate two.)</li>
<li>‚ÄúI had <em>no</em> cookies.‚Äù (You ate none.)</li>
<li>Nothing ‚Äì stay silent. (You could have eaten none or any number of cookies.)</li>
</ol>
<p>Let‚Äôs define this situation using a binary matrix. Each row is a signal (what you say) and each column is a state (how many cookies were eaten).</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="pragmatics.html#cb71-1" aria-hidden="true" tabindex="-1"></a>state_matrix <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb71-2"><a href="pragmatics.html#cb71-2" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>],</span>
<span id="cb71-3"><a href="pragmatics.html#cb71-3" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>],</span>
<span id="cb71-4"><a href="pragmatics.html#cb71-4" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]])</span>
<span id="cb71-5"><a href="pragmatics.html#cb71-5" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb71-6"><a href="pragmatics.html#cb71-6" aria-hidden="true" tabindex="-1"></a>signals <span class="op">=</span> [<span class="st">"some"</span>, <span class="st">"all"</span>, <span class="st">"no"</span>, <span class="st">"silent"</span>]</span>
<span id="cb71-7"><a href="pragmatics.html#cb71-7" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> [<span class="st">"0"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>]</span></code></pre></div>
<p>We‚Äôll define a function that prints out this matrix as a heat map.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="pragmatics.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_state_matrix(m, x_labels<span class="op">=</span><span class="va">None</span>, y_labels<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb72-2"><a href="pragmatics.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb72-3"><a href="pragmatics.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  im <span class="op">=</span> ax.imshow(m)</span>
<span id="cb72-4"><a href="pragmatics.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-5"><a href="pragmatics.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x_labels <span class="kw">and</span> y_labels):</span>
<span id="cb72-6"><a href="pragmatics.html#cb72-6" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(np.arange(<span class="bu">len</span>(x_labels)), labels<span class="op">=</span>x_labels)</span>
<span id="cb72-7"><a href="pragmatics.html#cb72-7" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks(np.arange(<span class="bu">len</span>(y_labels)), labels<span class="op">=</span>y_labels)</span>
<span id="cb72-8"><a href="pragmatics.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-9"><a href="pragmatics.html#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y_labels)):</span>
<span id="cb72-10"><a href="pragmatics.html#cb72-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x_labels)):</span>
<span id="cb72-11"><a href="pragmatics.html#cb72-11" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> ax.text(j, i, <span class="bu">round</span>(m[i, j],<span class="dv">2</span>),</span>
<span id="cb72-12"><a href="pragmatics.html#cb72-12" aria-hidden="true" tabindex="-1"></a>          ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, color<span class="op">=</span><span class="st">"w"</span>)</span>
<span id="cb72-13"><a href="pragmatics.html#cb72-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-14"><a href="pragmatics.html#cb72-14" aria-hidden="true" tabindex="-1"></a>  fig.tight_layout()</span>
<span id="cb72-15"><a href="pragmatics.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  plt.show()</span>
<span id="cb72-16"><a href="pragmatics.html#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="pragmatics.html#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print out the matrix</span></span>
<span id="cb72-18"><a href="pragmatics.html#cb72-18" aria-hidden="true" tabindex="-1"></a>print_state_matrix(state_matrix, states, signals)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-54-3.png" width="672"></div>
<p>Now let‚Äôs calculate how a literal listener would interpret each of these statements. Each row in the matrix above (one for each signal) will define a distribution over the states. That is, for for state <span class="math inline">\(h\)</span> and signal <span class="math inline">\(d\)</span>, we want to compute:</p>
<p><span class="math display">\[
P_{\text{listener}}(h|d) \propto P(d|h) P(h)
\]</span></p>
<p>The literal listener assumes that, given a state, a signal consistent with that state is chosen at random by the speaker. This is already captured in the matrix above: Signals consistent with a state have a value of 1 in their cells and signals inconsistent have a 0. We will also assume that the listener has a uniform prior over states. Therefore, we can calculate the literal listener‚Äôs probabilities by just normalizing the rows of the matrix.</p>
<p>We‚Äôll do this more than once, so let‚Äôs write a function to do it.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="pragmatics.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_rows(m):</span>
<span id="cb73-2"><a href="pragmatics.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  normalized_m <span class="op">=</span> np.zeros((m.shape))</span>
<span id="cb73-3"><a href="pragmatics.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  row_num <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb73-4"><a href="pragmatics.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> m:</span>
<span id="cb73-5"><a href="pragmatics.html#cb73-5" aria-hidden="true" tabindex="-1"></a>    normalized_m[row_num,:] <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb73-6"><a href="pragmatics.html#cb73-6" aria-hidden="true" tabindex="-1"></a>    row_num <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb73-7"><a href="pragmatics.html#cb73-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb73-8"><a href="pragmatics.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(normalized_m)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="pragmatics.html#cb74-1" aria-hidden="true" tabindex="-1"></a>literal_listener <span class="op">=</span> normalize_rows(state_matrix)</span>
<span id="cb74-2"><a href="pragmatics.html#cb74-2" aria-hidden="true" tabindex="-1"></a>print_state_matrix(literal_listener, states, signals)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-56-5.png" width="672"></div>
<p>Now let‚Äôs calculate the pragmatic speaker. The pragmatic speaker chooses a signal given a state. Therefore, this time, the <em>columns</em> of the matrix will be probability distributions.</p>
<p>Unlike the literal listener, the pragmatic speaker is trying to convey some information, so they will choose a signal with the greatest <em>expected utility</em> for the literal listener. Expected utility in this case is defined as the expected increase in understanding about the true state of the world. Remember, we already have a way of quantifying this: surprisal. So we‚Äôll define utility as negative surprisal of the state given the signal from the point of view of the literal listener: <span class="math inline">\(-(-log(P_{\text{listener}}(h|d)))\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="pragmatics.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we apply a softmax decision function</span></span>
<span id="cb75-2"><a href="pragmatics.html#cb75-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span> <span class="co"># paramater controls how close to maximizing speaker is</span></span>
<span id="cb75-3"><a href="pragmatics.html#cb75-3" aria-hidden="true" tabindex="-1"></a>pragmatic_speaker <span class="op">=</span> np.exp(np.log(literal_listener)<span class="op">*</span>alpha)</span></code></pre></div>
<pre><code>## &lt;string&gt;:1: RuntimeWarning: divide by zero encountered in log</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="pragmatics.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(pragmatic_speaker.shape[<span class="dv">1</span>]):</span>
<span id="cb77-2"><a href="pragmatics.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  pragmatic_speaker[:,col] <span class="op">=</span> (pragmatic_speaker[:,col] <span class="op">/</span></span>
<span id="cb77-3"><a href="pragmatics.html#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span>(pragmatic_speaker[:,col]))</span>
<span id="cb77-4"><a href="pragmatics.html#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="pragmatics.html#cb77-5" aria-hidden="true" tabindex="-1"></a>print_state_matrix(pragmatic_speaker, states, signals)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-57-7.png" width="672"></div>
<p>In the above code, I used something known as a ‚Äúsoftmax‚Äù rather than a true maximizing function. The exponential function captures the idea that the speaker will choose probabilistically, generally choosing options with more utility. This is a fairly common assumption in both psychology and economics because we often don‚Äôt have complete information when making decisions (or when modeling other people‚Äôs decisions), so assuming a pure maximizing function isn‚Äôt always the best choice.</p>
<p>However, I also included a parameter <code>alpha</code> that controls how close to maximizing the speaker is. The larger <code>alpha</code> is, the closer the speaker will get to maximizing utility.</p>
<p>Now we can calculate the probabilities for the pragmatic listener. This will be similar to the literal listener in that the pragmatic listener receives a signal and computes the probability of each state given a signal. The difference is that the pragmatic listener doesn‚Äôt assume the signals are chosen at random, but that the signals are chosen by the pragmatic speaker above.</p>
<p>We can compute the pragmatic listener by normalizing the matrix above along the rows.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="pragmatics.html#cb78-1" aria-hidden="true" tabindex="-1"></a>pragmatic_listener <span class="op">=</span> normalize_rows(pragmatic_speaker)</span>
<span id="cb78-2"><a href="pragmatics.html#cb78-2" aria-hidden="true" tabindex="-1"></a>print_state_matrix(pragmatic_listener, states, signals)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-58-9.png" width="672"></div>
<p>The pragmatic listener correctly infers a <a href="https://en.wikipedia.org/wiki/Scalar_implicature">scalar implicature</a>, a concept from pragmatics in linguistics. Even though ‚ÄúI had some cookies‚Äù is consistent with eating all of the cookies, a pragmatic listener will infer that if a person says they ate <em>some</em> then they did not eat <em>all</em> (otherwise they would have said so).</p>
</div>
<div id="does-this-model-match-human-behavior" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Does this model match human behavior? üîµ<a class="anchor" aria-label="anchor" href="#does-this-model-match-human-behavior"><i class="fas fa-link"></i></a>
</h2>
<p>In a word, yes. One of the <a href="http://langcog.stanford.edu/papers_new/frank-2012-science.pdf">first papers</a> to look at this was by Michael Frank and Noah Goodman. They applied this model to the simple task of picking out a shape from a small set and tested the model‚Äôs predictions in a behavioral experiment.</p>
<div id="the-task" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> The task<a class="anchor" aria-label="anchor" href="#the-task"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>The speaker</strong>: ‚ÄúImagine you are talking to someone and you want to refer to the middle object. What word would you use: <em>blue</em> or <em>circle</em>?‚Äù üü¶ üîµ üü©</li>
<li>
<strong>The listener</strong>: ‚ÄúImagine someone is talking to you and uses the word <em>blue</em> to refer to one of these objects. Which object are they talking about?‚Äù üü¶ üîµ üü©</li>
</ul>
<p>In the task and experiment, the researchers varied the actual set of objects in a systematic way.</p>
</div>
<div id="the-model-1" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> The model<a class="anchor" aria-label="anchor" href="#the-model-1"><i class="fas fa-link"></i></a>
</h3>
<p>Their model is virtually identical to the cookie jar model we just worked through. They assume that speakers try to choose words to maximize the listener‚Äôs utility, as measured by surprisal.</p>
<p>A literal listener in this case would assume that any object that is consistent with the speaker‚Äôs chosen word could have been the one they were referring to.</p>
<p>With these assumptions, the researchers derive the probability of the speaker choosing each word (details in the paper) as:</p>
<p><span class="math display">\[
P(w|r_s,C) = \frac{|w|^{-1}}{\sum_{w^\prime \in W} {|w^\prime|}^{-1}}
\]</span></p>
<ul>
<li>
<span class="math inline">\(w\)</span>: The speaker‚Äôs chosen word.</li>
<li>
<span class="math inline">\(r_s\)</span>: The object the speaker meant to refer to.</li>
<li>
<span class="math inline">\(C\)</span>: The set of objects.</li>
<li>
<span class="math inline">\(|w|\)</span>: The number of objects that <span class="math inline">\(w\)</span> could apply to.</li>
<li>
<span class="math inline">\(W\)</span>: The set of words that apply to the object that the speaker meant to refer to.</li>
</ul>
<p>Regarding <span class="math inline">\(W\)</span>, imagine that the speaker wanted to refer to the blue circle. In that case, <span class="math inline">\(W = \{ \text{blue}, \text{circle} \}\)</span>, because either word could apply to the object.</p>
<p>According to this model, speakers will tend to choose words that more uniquely identify an object in a set. For example, in the set above, because <em>blue</em> applies to two objects (blue square and blue circle), but <em>circle</em> only applies to one, <em>circle</em> will get higher probability.</p>
</div>
<div id="homework-4-implement-the-model" class="section level3" number="7.3.3">
<h3>
<span class="header-section-number">7.3.3</span> Homework 4: Implement the model<a class="anchor" aria-label="anchor" href="#homework-4-implement-the-model"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://colab.research.google.com/drive/107RdaavVkoQQS_1xoH7jnvbe0RA1AJy-?usp=sharing"><img src="https://colab.research.google.com/assets/colab-badge.svg"></a></p>
<p>I haven‚Äôt provided all the details for this model because your assignment is to finish the implementation yourself, run some simulations, and collect a small amount of real data to compare the model to.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sampling-assumptions.html"><span class="header-section-number">6</span> Sampling assumptions</a></div>
<div class="next"><a href="social-cognition.html"><span class="header-section-number">8</span> Social cognition</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#pragmatics"><span class="header-section-number">7</span> Language pragmatics</a></li>
<li><a class="nav-link" href="#surprisal"><span class="header-section-number">7.1</span> Surprisal üòØ</a></li>
<li><a class="nav-link" href="#rsa-model"><span class="header-section-number">7.2</span> The Rational Speech Act model üç™</a></li>
<li>
<a class="nav-link" href="#does-this-model-match-human-behavior"><span class="header-section-number">7.3</span> Does this model match human behavior? üîµ</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-task"><span class="header-section-number">7.3.1</span> The task</a></li>
<li><a class="nav-link" href="#the-model-1"><span class="header-section-number">7.3.2</span> The model</a></li>
<li><a class="nav-link" href="#homework-4-implement-the-model"><span class="header-section-number">7.3.3</span> Homework 4: Implement the model</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/alanjern/computational-psych-book/blob/main/07-RSA.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/alanjern/computational-psych-book/edit/main/07-RSA.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Computational Psychology</strong>" was written by Alan Jern. It was last built on 2022-04-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
